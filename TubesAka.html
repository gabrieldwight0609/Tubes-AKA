<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>AKA - Leaderboard Game System</title>
    <link rel="stylesheet" href="styling.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo"> Tugas Besar Analisis Kompleksitas Algoritma</div>
            <h1>Leaderboard Sorting System</h1>
            <p>Studi Kasus: Pengurutan Skor Pangkat Tertinggi Pemain</p>
        </header>

        <section class="input-section">
            <form action="/" method="POST">
                <div class="form-group">
                    <label for="n_size">Jumlah Pemain (n):</label>
                    <input type="number" id="n_size" name="n_size" placeholder="Cth: 1000">
            
                    <button type="submit" name="action" value="run">Jalankan Algoritma</button>
            
                    <button type="submit" name="action" value="reset" style="background: linear-gradient(135deg, #ef4444, #b91c1c); margin-left: 10px;">
                         Acak Ulang & Bersihkan
                    </button>
                </div>
            </form>
        </section>

        {{if .}}
            <div class="card">
                <div class="card-header"><h2> GRAFIK PERBANDINGAN RUNNING TIME (ms)</h2></div>
                <div style="padding: 20px;">
                    <canvas id="performanceChart" style="max-height: 400px;"></canvas>
                </div>
            </div>

            <div class="card leaderboard-card">
                <div class="card-header"><h2> TOP 10 RANKING (Hasil Pengurutan)</h2></div>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Nama Pemain</th>
                            <th>High Score (XP)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range (index . 0).TopPlayers}}
                        <tr>
                            <td class="rank-col">#{{.Rank}}</td>
                            <td>{{.Name}}</td>
                            <td class="score-col">{{.Score}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>

            <div class="card stats-card">
                <div class="card-header"><h2> RIWAYAT EKSEKUSI</h2></div>
                <table>
                    <thead>
                        <tr>
                            <th>Input (n)</th>
                            <th>Rekursif (ms)</th>
                            <th>Iteratif (ms)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .}}
                        <tr>
                            <td><strong>{{.N}} Pemain</strong></td>
                            <td class="time-val">{{printf "%.5f" .RekTime}} ms</td>
                            <td class="time-val">{{printf "%.5f" .IterTime}} ms</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        {{end}}
    </div>

    <script>
        const dataFromGo = [
            {{range .}}
            { n: {{.N}}, rek: {{.RekTime}}, iter: {{.IterTime}} },
            {{end}}
        ].reverse(); 

        const ctx = document.getElementById('performanceChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: dataFromGo.map(d => d.n),
                datasets: [
                    {
                        label: 'Rekursif (ms)',
                        data: dataFromGo.map(d => d.rek),
                        borderColor: '#38bdf8',
                        backgroundColor: 'rgba(56, 189, 248, 0.1)',
                        fill: true,
                        tension: 0.3
                    },
                    {
                        label: 'Iteratif (ms)',
                        data: dataFromGo.map(d => d.iter),
                        borderColor: '#fbbf24',
                        backgroundColor: 'rgba(251, 191, 36, 0.1)',
                        fill: true,
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: { 
                    legend: { labels: { color: '#f1f5f9' } } 
                },
                scales: {
                    x: { 
                        title: {
                            display: true,
                            text: 'Ukuran Data (n)',
                            color: '#94a3b8',
                            font: { size: 14, weight: 'bold' }
                        },
                        ticks: { color: '#94a3b8' }, 
                        grid: { color: 'rgba(255,255,255,0.05)' } 
                    },
                    y: { 
                        title: {
                            display: true,
                            text: 'Waktu (ms)',
                            color: '#94a3b8',
                            font: { size: 14, weight: 'bold' }
                        },
                        ticks: { color: '#94a3b8' }, 
                        grid: { color: 'rgba(255,255,255,0.05)' } 
                    }
                }
            }
        });
    </script>
</body>
</html>